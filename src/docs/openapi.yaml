openapi: 3.0.0
info:
  title: ZapBridge API
  version: 1.0.0
  description: API para envio de mensagens via WhatsApp usando Baileys

servers:
  - url: {SERVER_URL}
    description: URL da API (definida via vari치vel de ambiente)

tags:
  - name: Health
    description: Verifica칞칚o de status do servi칞o
  - name: Session
    description: Gerenciamento da sess칚o do WhatsApp
  - name: Messages
    description: Envio de mensagens

paths:
  /api/v1/health:
    get:
      tags:
        - Health
      summary: Verificar integridade do servi칞o
      responses:
        "200":
          description: Servi칞o em execu칞칚o
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  service:
                    type: string
                  status:
                    type: string
                  timestamp:
                    type: string
                    format: date-time

  /api/v1/session/status:
    get:
      tags:
        - Session
      summary: Verificar status da conex칚o
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Status retornado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  connected:
                    type: boolean
                  hasQR:
                    type: boolean

  /api/v1/session/qr:
    get:
      tags:
        - Session
      summary: Obter QR Code em Base64
      security:
        - BearerAuth: []
      responses:
        "200":
          description: QR Code retornado
          content:
            application/json:
              schema:
                type: object
                properties:
                  qr:
                    type: string
                    description: String Base64 da imagem QR Code
        "404":
          description: QR n칚o dispon칤vel ou j치 conectado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  connected:
                    type: boolean

  /api/v1/session/disconnect:
    post:
      tags:
        - Session
      summary: Desconectar e fazer logout do WhatsApp
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Sess칚o encerrada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string

  /api/v1/session/restart:
    post:
      tags:
        - Session
      summary: Reiniciar o servi칞o de conex칚o
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Reiniciando conex칚o
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string

  /api/v1/messages/send:
    post:
      tags:
        - Messages
      summary: Enviar mensagem via WhatsApp
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - message
              properties:
                number:
                  type: string
                  example: "5562999999999"
                  description: N칰mero com DDI e DDD (ex 5562999999999)
                message:
                  type: string
                  example: "Ol치 via API 游"
                delayMessage:
                  type: number
                  description: Delay em segundos antes de enviar a mensagem (1-15 seg). Default 1~3 seg.
                  example: 3
                delayTyping:
                  type: number
                  description: Tempo que ficar치 com o status "Digitando..." (1-15 seg). Default 0.
                  example: 5
      responses:
        "200":
          description: Mensagem enviada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "400":
          description: Dados inv치lidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string
        "500":
          description: Erro ao enviar mensagem
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
